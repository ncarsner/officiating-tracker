{% load static %}
<!DOCTYPE html>

<html>
    <head>
        <title>Officiating Tracker</title>
        <link rel="stylesheet" href="{% static 'css/output.css' %}?v=1733608000">
        <script>
            // Check for saved theme preference or default to light mode
            if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
                document.documentElement.classList.add('dark')
            } else {
                document.documentElement.classList.remove('dark')
            }
        </script>
    </head>
    <body class="bg-gray-100 dark:bg-gray-900 transition-colors duration-200">
        <header class="bg-white dark:bg-gray-800 shadow transition-colors duration-200">
            <nav class="container mx-auto px-4 py-2 flex justify-between items-center">
                <a href="{% url 'home' %}" class="flex items-center gap-2 text-2xl font-bold text-blue-600 dark:text-blue-400">
                    <img src="{% static 'app_logo.png' %}" alt="Officiating Tracker Logo" style="height: 4rem; width: auto;">
                    <span>Officiating Tracker</span>
                </a>

                <div class="flex items-center gap-3">
                    <!-- Theme Toggle Switch -->
                    <div class="flex items-center gap-2">
                        <span class="text-sm text-gray-700 dark:text-gray-300">‚òÄÔ∏è</span>
                        <button id="theme-toggle" class="relative inline-flex items-center h-6 rounded-full w-11 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 bg-gray-300 dark:bg-blue-600" aria-label="Toggle dark mode">
                            <span id="toggle-dot" class="inline-block w-4 h-4 transform bg-white rounded-full transition-transform translate-x-1 dark:translate-x-6"></span>
                        </button>
                        <span class="text-sm text-gray-700 dark:text-gray-300">üåô</span>
                    </div>
                    {% if user.is_authenticated %}
                        <a href="{% url 'game_list' %}" class="px-3 py-1 text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400">Games</a>
                        <a href="{% url 'add_game' %}" class="px-3 py-1 text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400">Add Game</a>

                        {% if user.is_staff %}
                            <a href="/admin/" class="px-3 py-1 text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400">Admin</a>
                        {% endif %}

                        <span class="text-gray-700 dark:text-gray-300">{{ user.username }}</span>
                        <a href="{% url 'account_change_password' %}" class="px-3 py-1 text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400">Change Password</a>
                        <a href="{% url 'account_logout' %}" class="px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700">Log Out</a>
                    {% else %}
                        <a href="{% url 'account_login' %}" class="px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700">Log In</a>
                        <a href="{% url 'account_signup' %}" class="px-3 py-1 bg-indigo-600 text-white rounded hover:bg-indigo-700">Sign Up</a>
                    {% endif %}
                </div>
            </nav>
        </header>

        <main class="container mx-auto px-4 py-6">
            {% if messages %}
                {% for message in messages %}
                    <div class="max-w-xl mx-auto mb-4 p-4 rounded {% if message.tags == 'success' %}bg-green-600{% elif message.tags == 'error' %}bg-red-600{% else %}bg-blue-600{% endif %} text-white">
                        {{ message }}
                    </div>
                {% endfor %}
            {% endif %}

            {% block content %}
            {% endblock %}
        </main>

        <script src="https://cdn.jsdelivr.net/npm/htmx.org@2.0.7/dist/htmx.min.js"></script>
        <script>
            const themeToggleBtn = document.getElementById('theme-toggle');
            const toggleDot = document.getElementById('toggle-dot');

            themeToggleBtn.addEventListener('click', function() {
                // Toggle dark mode on the html element
                if (document.documentElement.classList.contains('dark')) {
                    document.documentElement.classList.remove('dark');
                    localStorage.setItem('theme', 'light');
                } else {
                    document.documentElement.classList.add('dark');
                    localStorage.setItem('theme', 'dark');
                }
            });
        </script>
    </body>
</html>
